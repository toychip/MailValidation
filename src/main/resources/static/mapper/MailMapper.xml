<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mail.mailViolation.mapper.MailMapper">

    <select id="findEmployeeByDraftsmanAndApprReferYn" parameterType="string" resultType="com.mail.mailViolation.dto.EmployeeDao">
        SELECT EMP_ID, EMP_NAME, DEPT_ID, EMP_EMAIL, USE_YN, RGT_DTTM, APPR_REFER_YN
          FROM TB_AS_SCRT_EMP
         WHERE EMP_NAME = #{draftsman}
--            AND APPR_REFER_YN = 'N'
    </select>

    <!-- MyBatis Mapper XML -->
    <select id="findBossByDeptId" resultType="com.mail.mailViolation.dto.EmployeeDao">

        -- 현재 부서의 보직좌 조회
        SELECT E.EMP_ID, E.EMP_NAME, E.DEPT_ID, E.EMP_EMAIL, E.USE_YN, E.RGT_DTTM, E.APPR_REFER_YN
        FROM TB_AS_SCRT_EMP E
        WHERE E.DEPT_ID = #{deptId}
          AND E.APPR_REFER_YN = 'Y'
        UNION

        -- 상위 부서의 보직좌 조회
        SELECT E.EMP_ID, E.EMP_NAME, E.DEPT_ID, E.EMP_EMAIL, E.USE_YN, E.RGT_DTTM, E.APPR_REFER_YN
          FROM TB_AS_SCRT_EMP E
                 INNER JOIN TB_AS_SCRT_DEPT D ON E.DEPT_ID = D.DEPT_ID
         WHERE D.UPPER_DEPT = (SELECT UPPER_DEPT FROM TB_AS_SCRT_DEPT WHERE DEPT_ID = #{deptId})
          AND E.APPR_REFER_YN = 'Y'

    </select>






</mapper>